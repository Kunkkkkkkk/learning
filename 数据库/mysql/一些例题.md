1.查询姓名，性别，以及补助金额（补助按照性別基准值*commission_pct），男性基础2000，女性基准3000，#其他0，commission_pct为nu11算0.1比例

CASE WHEN

```sql
SELECT
    ename,
    gender,
    CASE
        WHEN gender = '男' THEN 2000 * IFNULL(commission_pct, 0.1)
        WHEN gender = '女' THEN 3000 * IFNULL(commission_pct, 0.1)
        ELSE 0
    END AS 补助金额
FROM
    t_employee;
```

2.给出生日算年纪

```sql
ROUND(DATADIFF(NOW()-birthDay))
```

3.找出每一种的库存，然后【库存总和】  

这里用到一个报表生成的一个 WITH rollup ，但是对应的那一行前面是null

所以可以这样

```
SELECT IFNULL(note,"总量"),sum(num) FROM books GROUP BY note with ROLLUP
```

![image-20240805102232769](/Users/elfish/Library/Application Support/typora-user-images/image-20240805102232769.png)
